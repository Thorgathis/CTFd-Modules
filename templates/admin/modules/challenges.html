{% extends "admin/modules/_layout.html" %}

{% set active_page = 'modules' %}

{% block ctfd_modules_title %}Module challenges{% endblock %}

{% block ctfd_modules_body %}
  <div class="d-flex justify-content-between align-items-center">
    <h2 class="mb-0">Challenges â€” {{ module.name }}</h2>
    <a class="btn btn-link" href="{{ url_for('ctfd_modules_admin.admin_modules_edit', module_id=module.id) }}">Back to module</a>
  </div>

      <div class="row mt-3">
        <div class="col-md-6">
          <h3>Assigned</h3>
          <table class="table table-sm">
            <thead>
              <tr>
                <th>Name</th>
                <th>Category</th>
                <th>Value</th>
                <th></th>
              </tr>
            </thead>
            <tbody>
              {% for c in assigned %}
              <tr>
                <td>{{ c.name }}</td>
                <td>{{ c.category }}</td>
                <td>{{ c.value }}</td>
                <td class="text-right">
                  <form method="post" action="{{ url_for('ctfd_modules_admin.admin_modules_challenges_unassign', module_id=module.id) }}">
                    <input type="hidden" name="nonce" value="{{ (nonce if nonce is defined else '') or ctfd_modules_nonce() }}">
                    <input type="hidden" name="challenge_id" value="{{ c.id }}">
                    <button class="btn btn-sm btn-outline-danger" type="submit">Remove</button>
                  </form>
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>

        <div class="col-md-6">
          <h3>Unassigned</h3>

          <form class="form-inline mb-2" method="get">
            <input class="form-control mr-2" name="q" value="{{ q }}" placeholder="search">
            <input class="form-control mr-2" name="category" value="{{ category }}" placeholder="category">
            <button class="btn btn-secondary" type="submit">Filter</button>
          </form>

          <table class="table table-sm">
            <thead>
              <tr>
                <th>Name</th>
                <th>Category</th>
                <th>Value</th>
                <th></th>
              </tr>
            </thead>
            <tbody>
              {% for c in unassigned %}
              <tr>
                <td>{{ c.name }}</td>
                <td>{{ c.category }}</td>
                <td>{{ c.value }}</td>
                <td class="text-right">
                  <form method="post" action="{{ url_for('ctfd_modules_admin.admin_modules_challenges_assign', module_id=module.id) }}">
                    <input type="hidden" name="nonce" value="{{ (nonce if nonce is defined else '') or ctfd_modules_nonce() }}">
                    <input type="hidden" name="challenge_id" value="{{ c.id }}">
                    <button class="btn btn-sm btn-outline-primary" type="submit">Add</button>
                  </form>
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>

          <div class="text-muted small">Showing {{ unassigned|length }} (limit {{ limit }})</div>
        </div>
      </div>

{% endblock %}
